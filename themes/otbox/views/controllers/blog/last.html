<? if ($blog) { ?>
    <div class="row row_8wyu row-main">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 col_1uej col-style">
            <div class="module so-latest-blog blog-home preset01-4 preset02-3 preset03-3 preset04-2 preset05-1">
                <h3 class="modtitle"><span><?=Lang::get('post')?></span></h3>
                <div class="modcontent clearfix">
                    <div id="so_latest_blog_288_16692616131568866878" class="so-blog-external buttom-type1 button-type1">
                        <div class="blog-external">
                            <? foreach ($blog as $post) { ?>
                            <? $date = $post['created']; ?>
                            <div class="media">
                                <div class="item head-button">
                                    <div class="media-left so-block">
                                        <a href="<?=UrlGenerator::generatPostUrl('post', $post['id'], $post['alias'])?>" target="_self">
                                            <img data-sizes="auto" src="<?=DigestRepository::getImage($post['image'], "thumb")?>" data-src="<?=DigestRepository::getImage($post['image'], "thumb")?>" alt="<?=$this->escape($post['title'])?>" class="lazyautosizes lazyloaded" sizes="229px">
                                        </a>
                                    </div>
                                    <div class="media-body">
                                        <div class="media-content so-block">
                                            <h4 class="media-heading font-title head-item">
                                                <a href="<?=UrlGenerator::generatPostUrl('post', $post['id'], $post['alias'])?>" title="<?=$this->escape($post['title'])?>" target="_self"><?=$this->escape($post['title'])?></a>
                                            </h4>
                                            <div class="media-date-added">
                                                <i class="fa fa-calendar"></i><span> <?=$date->format('d.m.Y')?></span>
                                            </div>
                                            <div class="description">
                                                <?=strip_tags($post['brief'])?>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <? } ?>
                        </div>
                    </div>
                    <!--a href="<?//=UrlGenerator::generateContentUrl('digest')?>" class="see-all-link"><?//=Lang::get('digest')?></a-->
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        //<![CDATA[
        jQuery(document).ready(function ($) {
            ;(function (element) {
                var $element = $(element),
                    $extraslider = $(".blog-external", $element),
                    _delay = 500,
                    _duration = 800,
                    _effect = 'none';

                this_item = $extraslider.find('div.media');
                this_item.find('div.item:eq(0)').addClass('head-button');
                this_item.find('div.item:eq(0) .media-heading').addClass('head-item');
                this_item.find('div.item:eq(0) .media-left').addClass('so-block');
                this_item.find('div.item:eq(0) .media-content').addClass('so-block');
                $extraslider.on("initialized.owl.carousel2", function () {
                    var $item_active = $(".owl2-item.active", $element);
                    if ($item_active.length > 1 && _effect != "none") {
                        _getAnimate($item_active);
                    }
                    else {
                        var $item = $(".owl2-item", $element);
                        $item.css({"opacity": 1, "filter": "alpha(opacity = 100)"});
                    }

                    $(".owl2-controls", $element).insertBefore($extraslider);
                    $(".owl2-dots", $element).insertAfter($(".owl2-prev", $element));
                });

                $extraslider.owlCarousel2({
                    margin: 30,
                    slideBy: 1,
                    autoplay: false,
                    autoplayHoverPause: false,
                    autoplayTimeout: 0,
                    autoplaySpeed: 1000,
                    startPosition: 0,
                    mouseDrag: true,
                    touchDrag: true,
                    autoWidth: false,
                    rtl: false,
                    responsive: {
                        0: 	{ items: 1 } ,
                        480: { items: 2 },
                        768: { items: 3 },
                        992: { items: 3 },
                        1200: {items: 4},
                    },
                    dotClass: "owl2-dot",
                    dotsClass: "owl2-dots",
                    dots: false,
                    dotsSpeed:500,
                    nav: true,
                    loop: true,
                    navSpeed: 500,
                    navText: ["&#171;", "&#187;"],
                    navClass: ["owl2-prev", "owl2-next"]
                });

                $extraslider.on("translate.owl.carousel2", function (e) {

                    //var $item_active = $(".owl2-item.active", $element);
                    //_UngetAnimate($item_active);
                    //_getAnimate($item_active);
                });

                $extraslider.on("translated.owl.carousel2", function (e) {

                    var $item_active = $(".owl2-item.active", $element);
                    var $item = $(".owl2-item", $element);

                    _UngetAnimate($item);

                    if ($item_active.length > 1 && _effect != "none") {
                        _getAnimate($item_active);
                    } else {
                        $item.css({"opacity": 1, "filter": "alpha(opacity = 100)"});
                    }
                });

                function _getAnimate($el) {
                    if (_effect == "none") return;
                    //if ($.browser.msie && parseInt($.browser.version, 10) <= 9) return;
                    $extraslider.removeClass("extra-animate");
                    $el.each(function (i) {
                        var $_el = $(this);
                        $(this).css({
                            "-webkit-animation": _effect + " " + _duration + "ms ease both",
                            "-moz-animation": _effect + " " + _duration + "ms ease both",
                            "-o-animation": _effect + " " + _duration + "ms ease both",
                            "animation": _effect + " " + _duration + "ms ease both",
                            "-webkit-animation-delay": +i * _delay + "ms",
                            "-moz-animation-delay": +i * _delay + "ms",
                            "-o-animation-delay": +i * _delay + "ms",
                            "animation-delay": +i * _delay + "ms",
                            "opacity": 1
                        }).animate({
                            opacity: 1
                        });

                        if (i == $el.size() - 1) {
                            $extraslider.addClass("extra-animate");
                        }
                    });
                }

                function _UngetAnimate($el) {
                    $el.each(function (i) {
                        $(this).css({
                            "animation": "",
                            "-webkit-animation": "",
                            "-moz-animation": "",
                            "-o-animation": "",
                            "opacity": 1
                        });
                    });
                }
            })("#so_latest_blog_288_16692616131568866878");
        });
        //]]>
    </script>
<? } ?>
